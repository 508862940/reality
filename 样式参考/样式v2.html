<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>äº’åŠ¨æ–‡å­—æ¸¸æˆ - æ‰‹æœºç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* ä¸»å®¹å™¨ */
        .game-container {
            width: 100%;
            height: 100vh;
            max-width: 430px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            background: #1a1a2e;
        }

        /* ä¸ŠåŠéƒ¨åˆ†å®¹å™¨ */
        .upper-section {
            height: 45vh;
            display: flex;
            flex-direction: column;
            background: linear-gradient(to bottom, #2d3561, #1a1a2e);
            border-bottom: 2px solid #16213e;
        }

        /* ä¸Šéƒ¨ä¸»è¦å†…å®¹åŒº */
        .upper-main {
            flex: 1;
            display: flex;
            padding: 10px;
            gap: 10px;
        }

        /* AåŒº - ç«‹ç»˜åŒºåŸŸ */
        .area-a {
            width: 35%;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .character-sprite {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.3));
        }

        /* å³ä¾§åŒºåŸŸå®¹å™¨ */
        .right-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* BåŒº - ä½ç½®æ—¶é—´ä¿¡æ¯ */
        .area-b {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            padding: 6px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #e4e4e7;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .location-info {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* CåŒº - æ™¯è‰²é¢„è§ˆ */
        .area-c {
            height: 60px;
            background: linear-gradient(to right, #4a5568, #2d3748);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: #94a3b8;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            position: relative;
        }

        .scene-preview {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: 
                repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 20px);
        }

        /* DåŒº - åŠŸèƒ½é¢æ¿ */
        .area-d {
            flex: 1;
            background: rgba(30, 30, 45, 0.8);
            border-radius: 12px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* åŠŸèƒ½æŒ‰é’®æ  */
        .function-tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            color: white;
        }

        .tab-btn:active {
            transform: scale(0.95);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 0 15px rgba(240, 147, 251, 0.5);
        }

        /* åŠŸèƒ½å†…å®¹åŒº */
        .function-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
            color: #e4e4e7;
            font-size: 13px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .stat-bar {
            width: 100px;
            height: 14px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 7px;
            overflow: hidden;
            position: relative;
        }

        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #f093fb, #f5576c);
            border-radius: 7px;
            transition: width 0.5s;
        }

        /* EåŒº - æé†’åŒºåŸŸ */
        .area-e {
            height: 30px;
            background: rgba(239, 68, 68, 0.1);
            border-top: 1px solid rgba(239, 68, 68, 0.3);
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-size: 12px;
            color: #fbbf24;
            overflow: hidden;
        }

        .notice-text {
            animation: slideLeft 10s linear infinite;
            white-space: nowrap;
        }

        @keyframes slideLeft {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* ä¸‹åŠéƒ¨åˆ† - FåŒºå‰§æƒ…åŒºåŸŸ */
        .lower-section {
            flex: 1;
            background: #0f0f23;
            display: flex;
            flex-direction: column;
            border-top: 2px solid #1a1a2e;
            position: relative;
        }

        /* F1åŒº - å‰§æƒ…æ–‡æœ¬å’Œé€‰é¡¹æ··åˆåŒº */
        .story-area {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            color: #e4e4e7;
            font-size: 14px;
            line-height: 1.6;
            /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
            scrollbar-width: thin;
            scrollbar-color: rgba(139, 92, 246, 0.3) transparent;
        }

        .story-area::-webkit-scrollbar {
            width: 6px;
        }

        .story-area::-webkit-scrollbar-track {
            background: transparent;
        }

        .story-area::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.3);
            border-radius: 3px;
        }

        .story-text {
            margin-bottom: 12px;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å‰§æƒ…ä¸­çš„é€‰é¡¹é“¾æ¥ - DoLé£æ ¼ */
        .story-choice {
            display: inline-block;
            color: #8b92f6;
            text-decoration: none;
            padding: 2px 6px;
            margin: 2px 0;
            border-bottom: 1px solid #8b92f6;
            transition: all 0.3s;
            cursor: pointer;
        }

        .story-choice:hover {
            color: #f093fb;
            border-bottom-color: #f093fb;
            background: rgba(139, 92, 246, 0.1);
        }

        .story-choice:active {
            transform: scale(0.98);
        }

        /* é€‰é¡¹å— - ç”¨äºå¤šä¸ªé€‰é¡¹ */
        .choice-block {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid rgba(139, 92, 246, 0.5);
            border-radius: 4px;
        }

        .choice-item {
            display: block;
            color: #a5b4fc;
            text-decoration: none;
            padding: 8px 10px;
            margin: 5px 0;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 6px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .choice-item:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateX(5px);
            color: #c7d2fe;
        }

        .choice-item:active {
            transform: translateX(3px) scale(0.98);
        }

        /* F2åŒº - AIè¾“å…¥åŒºåŸŸï¼ˆé»˜è®¤éšè—ï¼‰ */
        .ai-input-area {
            display: none;
            padding: 10px;
            background: rgba(30, 30, 45, 0.95);
            border-top: 2px solid rgba(139, 92, 246, 0.3);
            animation: slideUp 0.3s ease-out;
        }

        .ai-input-area.active {
            display: block;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .ai-input-wrapper {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .ai-input {
            flex: 1;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 20px;
            color: #e4e4e7;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
        }

        .ai-input:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(139, 92, 246, 0.6);
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.2);
        }

        .ai-input::placeholder {
            color: rgba(228, 228, 231, 0.4);
        }

        .ai-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8b92f6, #f093fb);
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-send-btn:active {
            transform: scale(0.9);
        }

        .ai-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* NPCæ ‡è¯† */
        .npc-name {
            color: #f093fb;
            font-weight: bold;
        }

        .npc-important {
            color: #fbbf24;
            font-weight: bold;
        }

        /* AIæ¨¡å¼æŒ‡ç¤ºå™¨ */
        .ai-mode-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 10px;
            background: linear-gradient(135deg, #8b92f6, #f093fb);
            border-radius: 12px;
            color: white;
            font-size: 10px;
            font-weight: bold;
            animation: pulse 2s infinite;
            display: none;
        }

        .ai-mode-indicator.active {
            display: block;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* å“åº”å¼é€‚é… */
        @media (max-height: 700px) {
            .upper-section {
                height: 40vh;
            }
            .area-c {
                height: 45px;
            }
            .tab-btn {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ä¸ŠåŠéƒ¨åˆ† -->
        <div class="upper-section">
            <div class="upper-main">
                <!-- AåŒº - ç«‹ç»˜ -->
                <div class="area-a">
                    <div style="text-align: center; color: #8b5cf6;">
                        <div style="font-size: 48px;">ğŸ‘§</div>
                        <div style="font-size: 10px; margin-top: 5px;">è§’è‰²ç«‹ç»˜</div>
                    </div>
                </div>

                <!-- å³ä¾§åŒºåŸŸ -->
                <div class="right-section">
                    <!-- BåŒº - ä½ç½®æ—¶é—´ -->
                    <div class="area-b">
                        <div class="location-info">
                            <span>ğŸ“ å­¦æ ¡Â·æ•™å®¤</span>
                        </div>
                        <div class="time-info">
                            <span>ğŸ• æ˜ŸæœŸä¸€ 08:30</span>
                        </div>
                    </div>

                    <!-- CåŒº - æ™¯è‰² -->
                    <div class="area-c">
                        <div class="scene-preview">
                            ğŸ« æ•™å®¤åœºæ™¯
                        </div>
                    </div>

                    <!-- DåŒº - åŠŸèƒ½é¢æ¿ -->
                    <div class="area-d">
                        <div class="function-tabs">
                            <div class="tab-btn active" title="çŠ¶æ€">ğŸ“Š</div>
                            <div class="tab-btn" title="èƒŒåŒ…">ğŸ’</div>
                            <div class="tab-btn" title="åœ°å›¾">ğŸ—ºï¸</div>
                            <div class="tab-btn" title="å±æ€§">â­</div>
                            <div class="tab-btn" title="ç¤¾äº¤">ğŸ‘¥</div>
                            <div class="tab-btn" title="æ—¥å¿—">ğŸ“–</div>
                            <div class="tab-btn" title="è®¾ç½®">âš™ï¸</div>
                        </div>
                        <div class="function-content">
                            <!-- çŠ¶æ€å†…å®¹ç¤ºä¾‹ -->
                            <div class="stat-item">
                                <span>ä½“åŠ›</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" style="width: 80%;"></div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <span>å¿ƒæƒ…</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" style="width: 60%;"></div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <span>å­¦ä¹ </span>
                                <div class="stat-bar">
                                    <div class="stat-fill" style="width: 45%;"></div>
                                </div>
                            </div>
                            <div class="stat-item">
                                <span>ç¤¾äº¤</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" style="width: 70%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EåŒº - æé†’ -->
            <div class="area-e">
                <span class="notice-text">ğŸ’¡ æé†’ï¼šç¬¬ä¸€èŠ‚è¯¾å³å°†å¼€å§‹ï¼Œè¯·å°½å¿«å‰å¾€æ•™å®¤...</span>
            </div>
        </div>

        <!-- ä¸‹åŠéƒ¨åˆ† - FåŒº -->
        <div class="lower-section">
            <!-- AIæ¨¡å¼æŒ‡ç¤ºå™¨ -->
            <div class="ai-mode-indicator" id="aiModeIndicator">AIå¯¹è¯æ¨¡å¼</div>

            <!-- F1åŒº - å‰§æƒ…æ–‡æœ¬å’Œé€‰é¡¹æ··åˆ -->
            <div class="story-area" id="storyArea">
                <!-- å‰§æƒ…æ®µè½ -->
                <div class="story-text">
                    æ¸…æ™¨çš„é˜³å…‰é€è¿‡æ•™å®¤çš„çª—æˆ·æ´’åœ¨è¯¾æ¡Œä¸Šï¼Œå½¢æˆæ–‘é©³çš„å…‰å½±ã€‚ä½ ååœ¨é çª—çš„ä½ç½®ï¼Œå¾®é£è½»è½»å¹åŠ¨ç€çª—å¸˜ã€‚
                </div>
                
                <div class="story-text">
                    æ•™å®¤é‡Œå·²ç»æœ‰å‡ ä¸ªæ—©åˆ°çš„åŒå­¦åœ¨å°å£°äº¤è°ˆã€‚ä½ æ³¨æ„åˆ°å‰æ’çš„<span class="npc-important">æ—å­¦é•¿</span>æ­£åœ¨è®¤çœŸåœ°ç¿»é˜…ç€ç¬”è®°ï¼Œä»–ä¼¼ä¹å¯Ÿè§‰åˆ°äº†ä½ çš„ç›®å…‰ï¼Œå›è¿‡å¤´æ¥å¯¹ä½ å¾®ç¬‘äº†ä¸€ä¸‹ã€‚
                </div>

                <div class="story-text">
                    "æ—©ä¸Šå¥½ï¼Œ"ä»–æ¸©æŸ”åœ°è¯´é“ï¼Œ"æ˜¨å¤©çš„ä½œä¸šå®Œæˆäº†å—ï¼Ÿå¦‚æœæœ‰ä¸æ‡‚çš„åœ°æ–¹ï¼Œæˆ‘å¯ä»¥å¸®ä½ ã€‚"
                </div>

                <!-- DoLé£æ ¼çš„é€‰é¡¹ - åµŒå…¥åœ¨æ–‡å­—ä¸­ -->
                <div class="story-text">
                    ä½ å¯ä»¥<a class="story-choice" onclick="makeChoice('ask-help')">è¯·æ•™æ—å­¦é•¿é—®é¢˜</a>ï¼Œæˆ–è€…<a class="story-choice" onclick="makeChoice('thank')">ç¤¼è²Œåœ°é“è°¢</a>ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥<a class="story-choice" onclick="makeChoice('ignore')">ä¸“å¿ƒæ•´ç†è‡ªå·±çš„è¯¾æœ¬</a>ã€‚
                </div>

                <!-- é€‰é¡¹å— - ç”¨äºæ›´å¤šé€‰é¡¹ -->
                <div class="choice-block">
                    <div style="color: #94a3b8; font-size: 12px; margin-bottom: 8px;">å…¶ä»–è¡ŒåŠ¨ï¼š</div>
                    <a class="choice-item" onclick="makeChoice('look-around')">ğŸ“ ç¯é¡¾æ•™å®¤</a>
                    <a class="choice-item" onclick="makeChoice('check-bag')">ğŸ’ æ£€æŸ¥èƒŒåŒ…</a>
                    <a class="choice-item" onclick="makeChoice('leave')">ğŸš¶ ç¦»å¼€æ•™å®¤</a>
                    <a class="choice-item" onclick="makeChoice('ai-talk')" style="background: linear-gradient(135deg, rgba(139, 146, 246, 0.2), rgba(240, 147, 251, 0.2)); border: 1px solid rgba(240, 147, 251, 0.3);">
                        âœ¨ ä¸æ—å­¦é•¿è‡ªç”±å¯¹è¯ï¼ˆAIæ¨¡å¼ï¼‰
                    </a>
                </div>

                <!-- æ›´å¤šå‰§æƒ…å†…å®¹ç¤ºä¾‹ - å±•ç¤ºæ»šåŠ¨æ•ˆæœ -->
                <div class="story-text" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                    ã€ä¹‹å‰çš„è®°å½•ã€‘
                </div>
                <div class="story-text">
                    ä½ æ˜¯ä¸€åæ™®é€šçš„é«˜ä¸­ç”Ÿï¼Œä»Šå¤©æ˜¯æ–°å­¦æœŸçš„ç¬¬ä¸€å¤©ã€‚æ˜¨æ™šå› ä¸ºå…´å¥‹è€Œç¡å¾—å¾ˆæ™šï¼Œå·®ç‚¹è¿Ÿåˆ°ã€‚
                </div>
                <div class="story-text">
                    è·¯ä¸Šé‡åˆ°äº†<span class="npc-name">å°æ˜</span>ï¼Œä»–æ˜¯ä½ çš„é’æ¢…ç«¹é©¬ã€‚ä»–å…³å¿ƒåœ°é—®ä½ æ˜¯å¦å‡†å¤‡å¥½äº†æ–°å­¦æœŸçš„æŒ‘æˆ˜ã€‚
                </div>
                <div class="story-text">
                    ä½ å‘Šè¯‰ä»–ä½ æœ‰äº›ç´§å¼ ï¼Œä½†ä¹Ÿå¾ˆæœŸå¾…ã€‚å°æ˜æ‹äº†æ‹ä½ çš„è‚©è†€ï¼Œè¯´ä»–ä¼šä¸€ç›´æ”¯æŒä½ çš„ã€‚
                </div>
                <div class="story-text">
                    è¿›å…¥å­¦æ ¡åï¼Œä½ å‘ç°ä»Šå¤©çš„æ°”æ°›æ ¼å¤–çƒ­é—¹ã€‚åŸæ¥æ˜¯å› ä¸ºæœ‰ä¸€ä½<span class="npc-important">ç¥ç§˜çš„è½¬å­¦ç”Ÿ</span>è¦æ¥ã€‚
                </div>
                <div class="story-text">
                    æ®è¯´è¿™ä½è½¬å­¦ç”Ÿæ¥è‡ªå›½å¤–ï¼Œæœ‰ç€ä¸å¯»å¸¸çš„èƒŒæ™¯ã€‚åŒå­¦ä»¬éƒ½åœ¨è®®è®ºçº·çº·ï¼ŒçŒœæµ‹ä»–ä¼šæ˜¯ä»€ä¹ˆæ ·çš„äººã€‚
                </div>
            </div>

            <!-- F2åŒº - AIè¾“å…¥åŒºåŸŸ -->
            <div class="ai-input-area" id="aiInputArea">
                <div class="ai-input-wrapper">
                    <input type="text" class="ai-input" id="aiInput" placeholder="è¾“å…¥ä½ æƒ³å¯¹æ—å­¦é•¿è¯´çš„è¯..." />
                    <button class="ai-send-btn" id="aiSendBtn" onclick="sendAIMessage()">
                        â¤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
        const tabBtns = document.querySelectorAll('.tab-btn');
        const functionContent = document.querySelector('.function-content');

        // ä¸åŒæ ‡ç­¾é¡µçš„å†…å®¹
        const tabContents = {
            0: `<!-- çŠ¶æ€ -->
                <div class="stat-item">
                    <span>ä½“åŠ›</span>
                    <div class="stat-bar"><div class="stat-fill" style="width: 80%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>å¿ƒæƒ…</span>
                    <div class="stat-bar"><div class="stat-fill" style="width: 60%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>å­¦ä¹ </span>
                    <div class="stat-bar"><div class="stat-fill" style="width: 45%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>ç¤¾äº¤</span>
                    <div class="stat-bar"><div class="stat-fill" style="width: 70%;"></div></div>
                </div>`,
            1: `<!-- èƒŒåŒ… -->
                <div style="padding: 5px;">
                    <div style="margin-bottom: 8px;">ğŸ“š æ•™ç§‘ä¹¦ x3</div>
                    <div style="margin-bottom: 8px;">âœï¸ ç¬”è®°æœ¬ x2</div>
                    <div style="margin-bottom: 8px;">ğŸ è‹¹æœ x1</div>
                    <div style="margin-bottom: 8px;">ğŸ’° é‡‘é’±: Â¥500</div>
                </div>`,
            2: `<!-- åœ°å›¾ -->
                <div style="padding: 5px; font-size: 12px;">
                    <div style="margin-bottom: 6px;">ğŸ“ å½“å‰: æ•™å®¤</div>
                    <div style="margin-bottom: 4px;">å¯å‰å¾€:</div>
                    <div style="margin-left: 10px;">â€¢ èµ°å»Š</div>
                    <div style="margin-left: 10px;">â€¢ æ“åœº</div>
                    <div style="margin-left: 10px;">â€¢ å›¾ä¹¦é¦†</div>
                    <div style="margin-left: 10px;">â€¢ é£Ÿå ‚</div>
                </div>`,
            3: `<!-- å±æ€§ -->
                <div style="padding: 5px; font-size: 12px;">
                    <div style="margin-bottom: 6px;">æ™ºåŠ›: â­â­â­â˜†â˜†</div>
                    <div style="margin-bottom: 6px;">ä½“åŠ›: â­â­â­â­â˜†</div>
                    <div style="margin-bottom: 6px;">é­…åŠ›: â­â­â­â˜†â˜†</div>
                    <div style="margin-bottom: 6px;">å‹‡æ°”: â­â­â˜†â˜†â˜†</div>
                </div>`,
            4: `<!-- ç¤¾äº¤ -->
                <div style="padding: 5px; font-size: 12px;">
                    <div style="margin-bottom: 6px;">æ—å­¦é•¿: â¤ï¸â¤ï¸â¤ï¸ğŸ¤ğŸ¤</div>
                    <div style="margin-bottom: 6px;">å¼ åŒå­¦: â¤ï¸â¤ï¸ğŸ¤ğŸ¤ğŸ¤</div>
                    <div style="margin-bottom: 6px;">å¤œåŒå­¦: â¤ï¸ğŸ¤ğŸ¤ğŸ¤ğŸ¤</div>
                    <div style="margin-bottom: 6px;">å°æ˜: â¤ï¸â¤ï¸â¤ï¸â¤ï¸ğŸ¤</div>
                </div>`,
            5: `<!-- æ—¥å¿— -->
                <div style="padding: 5px; font-size: 11px; line-height: 1.4;">
                    <div style="margin-bottom: 6px;">ğŸ“… ç¬¬1å¤© - æ˜ŸæœŸä¸€</div>
                    <div style="margin-bottom: 4px;">â€¢ æ¥åˆ°å­¦æ ¡</div>
                    <div style="margin-bottom: 4px;">â€¢ é‡åˆ°æ—å­¦é•¿</div>
                    <div style="margin-bottom: 4px;">â€¢ å‡†å¤‡ä¸Šè¯¾</div>
                </div>`,
            6: `<!-- è®¾ç½® -->
                <div style="padding: 5px; font-size: 12px;">
                    <div style="margin-bottom: 8px;">ğŸ”Š éŸ³æ•ˆ: å¼€å¯</div>
                    <div style="margin-bottom: 8px;">ğŸµ éŸ³ä¹: å¼€å¯</div>
                    <div style="margin-bottom: 8px;">ğŸ“± éœ‡åŠ¨: å…³é—­</div>
                    <div style="margin-bottom: 8px;">ğŸ’¾ è‡ªåŠ¨å­˜æ¡£: å¼€å¯</div>
                </div>`
        };

        tabBtns.forEach((btn, index) => {
            btn.addEventListener('click', () => {
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                functionContent.innerHTML = tabContents[index];
            });
        });

        // é€‰æ‹©å¤„ç†å‡½æ•°
        function makeChoice(choice) {
            const storyArea = document.getElementById('storyArea');
            
            // ç‰¹æ®Šå¤„ç†ï¼šAIå¯¹è¯æ¨¡å¼
            if (choice === 'ai-talk') {
                activateAIMode();
                return;
            }

            // æ™®é€šé€‰é¡¹å¤„ç†
            const responses = {
                'ask-help': '<div class="story-text">ä½ èµ°å‘æ—å­¦é•¿ï¼Œç¤¼è²Œåœ°è¯·æ•™äº†å‡ ä¸ªæ•°å­¦é—®é¢˜ã€‚ä»–è€å¿ƒåœ°ä¸ºä½ è®²è§£ï¼Œä½ æ„Ÿè§‰æ”¶è·å¾ˆå¤§ã€‚<span style="color: #10b981;">ã€å­¦ä¹  +5ã€‘ã€æ—å­¦é•¿å¥½æ„Ÿåº¦ +3ã€‘</span></div>',
                'thank': '<div class="story-text">ä½ å¾®ç¬‘ç€å¯¹æ—å­¦é•¿è¯´ï¼š"è°¢è°¢å­¦é•¿çš„å…³å¿ƒï¼Œæˆ‘å·²ç»å®Œæˆäº†ã€‚"ä»–ç‚¹ç‚¹å¤´ï¼Œç»§ç»­çœ‹ä¹¦ã€‚</div>',
                'ignore': '<div class="story-text">ä½ æ²¡æœ‰å›åº”ï¼Œç»§ç»­æ•´ç†è‡ªå·±çš„è¯¾æœ¬ã€‚æ—å­¦é•¿ä¹Ÿæ²¡æœ‰å†è¯´ä»€ä¹ˆã€‚</div>',
                'look-around': '<div class="story-text">ä½ ç¯é¡¾æ•™å®¤ï¼Œå‘ç°è§’è½é‡Œæœ‰ä¸ªé™Œç”Ÿçš„èº«å½±ï¼Œä¼¼ä¹æ˜¯ä¼ è¯´ä¸­çš„è½¬å­¦ç”Ÿã€‚</div>',
                'check-bag': '<div class="story-text">ä½ æ£€æŸ¥äº†èƒŒåŒ…ï¼Œç¡®è®¤æ‰€æœ‰çš„è¯¾æœ¬éƒ½å¸¦é½äº†ã€‚</div>',
                'leave': '<div class="story-text">ä½ èµ·èº«ç¦»å¼€æ•™å®¤ï¼Œèµ°å‘èµ°å»Šã€‚</div>'
            };

            // æ·»åŠ å“åº”åˆ°å‰§æƒ…åŒº
            const newContent = responses[choice] || '<div class="story-text">ä½ åšå‡ºäº†é€‰æ‹©ã€‚</div>';
            storyArea.innerHTML += newContent;

            // æ»šåŠ¨åˆ°åº•éƒ¨
            storyArea.scrollTop = storyArea.scrollHeight;
        }

        // æ¿€æ´»AIå¯¹è¯æ¨¡å¼
        function activateAIMode() {
            const aiInputArea = document.getElementById('aiInputArea');
            const aiModeIndicator = document.getElementById('aiModeIndicator');
            const storyArea = document.getElementById('storyArea');

            // æ˜¾ç¤ºAIè¾“å…¥åŒºå’ŒæŒ‡ç¤ºå™¨
            aiInputArea.classList.add('active');
            aiModeIndicator.classList.add('active');

            // æ·»åŠ æç¤ºæ–‡å­—
            storyArea.innerHTML += `
                <div class="story-text" style="background: linear-gradient(135deg, rgba(139, 146, 246, 0.1), rgba(240, 147, 251, 0.1)); padding: 10px; border-radius: 8px; margin-top: 10px;">
                    <span style="color: #f093fb;">ã€AIå¯¹è¯æ¨¡å¼å·²æ¿€æ´»ã€‘</span><br>
                    ç°åœ¨ä½ å¯ä»¥è‡ªç”±åœ°ä¸æ—å­¦é•¿å¯¹è¯äº†ã€‚è¾“å…¥ä½ æƒ³è¯´çš„è¯ï¼Œä»–ä¼šæ ¹æ®æ€§æ ¼åšå‡ºå›åº”ã€‚<br>
                    <small style="color: #94a3b8;">æç¤ºï¼šè¾“å…¥"ç»“æŸå¯¹è¯"å¯ä»¥é€€å‡ºAIæ¨¡å¼</small>
                </div>
            `;

            // èšç„¦è¾“å…¥æ¡†
            document.getElementById('aiInput').focus();

            // æ»šåŠ¨åˆ°åº•éƒ¨
            storyArea.scrollTop = storyArea.scrollHeight;
        }

        // å‘é€AIæ¶ˆæ¯
        function sendAIMessage() {
            const aiInput = document.getElementById('aiInput');
            const storyArea = document.getElementById('storyArea');
            const message = aiInput.value.trim();

            if (!message) return;

            // æ£€æŸ¥æ˜¯å¦ç»“æŸå¯¹è¯
            if (message === 'ç»“æŸå¯¹è¯') {
                deactivateAIMode();
                return;
            }

            // æ˜¾ç¤ºç©å®¶æ¶ˆæ¯
            storyArea.innerHTML += `
                <div class="story-text">
                    <span style="color: #8b92f6;">ä½ ï¼š</span>"${message}"
                </div>
            `;

            // æ¸…ç©ºè¾“å…¥æ¡†
            aiInput.value = '';

            // æ¨¡æ‹ŸAIå›å¤ï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„AI APIï¼‰
            setTimeout(() => {
                const aiResponse = generateAIResponse(message);
                storyArea.innerHTML += `
                    <div class="story-text">
                        <span class="npc-important">æ—å­¦é•¿ï¼š</span>"${aiResponse}"
                    </div>
                `;
                storyArea.scrollTop = storyArea.scrollHeight;
            }, 1000);

            // æ»šåŠ¨åˆ°åº•éƒ¨
            storyArea.scrollTop = storyArea.scrollHeight;
        }

        // æ¨¡æ‹ŸAIå“åº”ï¼ˆå®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºçœŸå®AIè°ƒç”¨ï¼‰
        function generateAIResponse(input) {
            const responses = [
                "è¿™æ˜¯ä¸ªæœ‰è¶£çš„æƒ³æ³•ï¼Œèƒ½å‘Šè¯‰æˆ‘æ›´å¤šå—ï¼Ÿ",
                "æˆ‘ç†è§£ä½ çš„æ„Ÿå—ï¼Œè®©æˆ‘ä»¬ä¸€èµ·åŠªåŠ›å§ã€‚",
                "å—¯ï¼Œè¿™ä¸ªé—®é¢˜ç¡®å®éœ€è¦ä»”ç»†æ€è€ƒ...",
                "ä½ çœŸçš„å¾ˆç‰¹åˆ«ï¼Œæˆ‘å¾ˆé«˜å…´èƒ½å’Œä½ èŠå¤©ã€‚",
                "å¦‚æœä½ éœ€è¦å¸®åŠ©ï¼Œéšæ—¶å¯ä»¥æ‰¾æˆ‘ã€‚"
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // é€€å‡ºAIæ¨¡å¼
        function deactivateAIMode() {
            const aiInputArea = document.getElementById('aiInputArea');
            const aiModeIndicator = document.getElementById('aiModeIndicator');
            const storyArea = document.getElementById('storyArea');

            aiInputArea.classList.remove('active');
            aiModeIndicator.classList.remove('active');

            storyArea.innerHTML += `
                <div class="story-text">
                    <span style="color: #94a3b8;">ã€AIå¯¹è¯æ¨¡å¼å·²å…³é—­ã€‘</span>
                </div>
            `;

            storyArea.scrollTop = storyArea.scrollHeight;
        }

        // å›è½¦å‘é€æ¶ˆæ¯
        document.getElementById('aiInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendAIMessage();
            }
        });
    </script>
</body>
</html>