<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>æ’å›¾æµ®å±‚ç³»ç»Ÿæ¼”ç¤º - Realityæ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, "PingFang SC", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 20px;
            max-width: 430px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .title {
            color: #f093fb;
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
        }

        /* F1åŒºæ¨¡æ‹Ÿ */
        .f1-area {
            background: #0f0f23;
            border-radius: 8px;
            padding: 20px;
            color: #e4e4e7;
            height: 400px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.8;
        }

        .f1-area::-webkit-scrollbar {
            width: 4px;
        }

        .f1-area::-webkit-scrollbar-track {
            background: transparent;
        }

        .f1-area::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.2);
            border-radius: 2px;
        }

        .location-tag {
            color: #8b92f6;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .story-text {
            margin-bottom: 20px;
        }

        .story-text p {
            margin-bottom: 12px;
        }

        /* å†…åµŒæ’å›¾æç¤º */
        .inline-illustration-hint {
            display: inline-block;
            padding: 6px 12px;
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(240, 147, 251, 0.3);
            border-radius: 16px;
            color: #f093fb;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 0;
        }

        .inline-illustration-hint:hover {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.2), rgba(139, 92, 246, 0.2));
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(240, 147, 251, 0.2);
        }

        .inline-illustration-hint::before {
            content: "ğŸ–¼ï¸ ";
            margin-right: 4px;
        }

        /* é€‰é¡¹ */
        .choice-item {
            display: block;
            padding: 12px 16px;
            margin: 10px 0;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            color: #a5b4fc;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .choice-item:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateX(5px);
            border-color: rgba(139, 92, 246, 0.4);
        }

        /* æœ‰æ’å›¾çš„é€‰é¡¹æ ‡è®° */
        .choice-item.has-illustration::after {
            content: "ğŸ–¼ï¸";
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            opacity: 0.6;
        }

        /* F2åŒºæ¨¡æ‹Ÿ */
        .f2-area {
            margin-top: 15px;
            padding: 12px;
            background: rgba(30, 30, 45, 0.95);
            border-radius: 8px;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .control-btn {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: #e4e4e7;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
            position: relative;
        }

        .control-btn:hover:not(:disabled) {
            background: rgba(139, 92, 246, 0.3);
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .zoom-btn {
            background: rgba(240, 147, 251, 0.2);
            border-color: rgba(240, 147, 251, 0.3);
        }

        .zoom-btn.has-content::after {
            content: "";
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            background: #f093fb;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        /* ===== æ ¸å¿ƒï¼šæµ®å±‚æ¨¡æ€æ¡† ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0);
            backdrop-filter: blur(0px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
        }

        /* æ¨¡æ€æ¡†å†…å®¹ */
        .modal-content {
            background: linear-gradient(135deg, #1e1e2e, #2a2a3e);
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 100px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.8) translateY(20px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
            opacity: 1;
        }

        /* æ¨¡æ€æ¡†å¤´éƒ¨ */
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.2);
        }

        .modal-title {
            color: #f093fb;
            font-size: 16px;
            font-weight: 500;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #e4e4e7;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 18px;
        }

        .modal-close:hover {
            background: rgba(255, 71, 87, 0.2);
            transform: rotate(90deg);
        }

        /* æ¨¡æ€æ¡†ä¸»ä½“ */
        .modal-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 300px;
        }

        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: rgba(139, 92, 246, 0.3);
            border-radius: 4px;
        }

        /* æ’å›¾å®¹å™¨ */
        .illustration-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .illustration-image {
            width: 100%;
            max-width: 600px;
            aspect-ratio: 16 / 9;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(240, 147, 251, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
            position: relative;
            overflow: hidden;
            cursor: zoom-in;
            transition: transform 0.3s ease;
        }

        .illustration-image:hover {
            transform: scale(1.02);
        }

        .illustration-image.zoomed {
            cursor: zoom-out;
            transform: scale(1.5);
        }

        /* æ’å›¾æè¿° */
        .illustration-info {
            text-align: center;
            max-width: 600px;
        }

        .illustration-caption {
            color: #e4e4e7;
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .illustration-desc {
            color: #94a3b8;
            font-size: 14px;
            line-height: 1.6;
        }

        /* æ¨¡æ€æ¡†åº•éƒ¨ */
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.2);
        }

        .modal-action {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: #e4e4e7;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            text-align: center;
        }

        .modal-action:hover {
            background: rgba(139, 92, 246, 0.3);
            transform: translateY(-1px);
        }

        .modal-action.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
        }

        /* å¤šå›¾æŒ‡ç¤ºå™¨ */
        .image-indicators {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .indicator-dot.active {
            width: 24px;
            border-radius: 4px;
            background: #f093fb;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid rgba(139, 92, 246, 0.1);
            border-top-color: #8b92f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* PWAè§¦æ‘¸ä¼˜åŒ– */
        @media (pointer: coarse) {
            .modal-content {
                max-height: 90vh;
            }

            .illustration-image {
                touch-action: pinch-zoom;
            }
        }

        /* æç¤ºä¿¡æ¯ */
        .tips {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 8px;
            color: #fbbf24;
            font-size: 13px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">ğŸ¨ æ’å›¾æµ®å±‚ç³»ç»Ÿæ¼”ç¤º</h1>

        <!-- F1åŒº -->
        <div class="f1-area">
            <div class="location-tag">ğŸ“ åºŸå¼ƒçš„å®éªŒå®¤</div>
            <div class="story-text">
                <p>æ˜æš—çš„åº”æ€¥ç¯å…‰ä¸‹ï¼Œå®éªŒå®¤æ˜¾å¾—æ ¼å¤–è¯¡å¼‚ã€‚</p>
                <p>å¢™ä¸Šè´´æ»¡äº†å¤æ‚çš„å›¾è¡¨å’Œå…¬å¼ï¼Œå…¶ä¸­ä¸€å¼ ç‰¹åˆ«å¼•äººæ³¨ç›®...</p>

                <span class="inline-illustration-hint" onclick="showIllustration('diagram')">
                    æŸ¥çœ‹å¢™ä¸Šçš„ç¥ç§˜å›¾è¡¨
                </span>

                <p>æ¡Œä¸Šæ•£è½ç€å„ç§å®éªŒå™¨æï¼Œä¸€æœ¬æ‰“å¼€çš„æ—¥è®°æœ¬å¸å¼•äº†ä½ çš„æ³¨æ„ã€‚</p>
                <p>ä½ è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
            </div>

            <div class="choice-item has-illustration" onclick="showIllustration('diary')">
                â†’ æŸ¥çœ‹æ—¥è®°æœ¬
            </div>
            <div class="choice-item has-illustration" onclick="showIllustration('device')">
                â†’ æ£€æŸ¥å®éªŒè®¾å¤‡
            </div>
            <div class="choice-item" onclick="selectChoice(this)">
                â†’ ç¦»å¼€å®éªŒå®¤
            </div>
            <div class="choice-item has-illustration" onclick="showIllustration('photo')">
                â†’ æ‹¿èµ·æ¡Œä¸Šçš„ç…§ç‰‡
            </div>
        </div>

        <!-- F2åŒº -->
        <div class="f2-area">
            <button class="control-btn" onclick="continueStory()">â–¶ï¸ ç»§ç»­</button>
            <button class="control-btn" onclick="resetScene()">â†©ï¸ é‡ç½®</button>
            <button class="control-btn zoom-btn has-content" onclick="showIllustration('scene')">
                ğŸ” åœºæ™¯
            </button>
        </div>

        <!-- æç¤º -->
        <div class="tips">
            ğŸ’¡ <strong>æ¼”ç¤ºè¯´æ˜ï¼š</strong><br>
            â€¢ ç‚¹å‡»æ–‡æœ¬ä¸­çš„æç¤ºæˆ–å¸¦ğŸ–¼ï¸çš„é€‰é¡¹æŸ¥çœ‹æ’å›¾<br>
            â€¢ æµ®å±‚æ”¯æŒç‚¹å‡»å›¾ç‰‡æ”¾å¤§ã€ESCå…³é—­<br>
            â€¢ æœªæ¥å¯æ‰©å±•ä¸ºæ‰‹æœºç•Œé¢ã€æ—¥è®°æœ¬ã€çƒ¹é¥ªç•Œé¢ç­‰
        </div>
    </div>

    <!-- æµ®å±‚æ¨¡æ€æ¡† -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeOnBackground(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">æ’å›¾æ ‡é¢˜</h3>
                <button class="modal-close" onclick="closeModal()">âœ•</button>
            </div>

            <div class="modal-body">
                <div class="illustration-container">
                    <div class="illustration-image" id="illustrationImage" onclick="toggleZoom()">
                        <!-- æ’å›¾å†…å®¹ -->
                    </div>

                    <div class="illustration-info">
                        <div class="illustration-caption" id="illustrationCaption">
                            æ’å›¾è¯´æ˜
                        </div>
                        <div class="illustration-desc" id="illustrationDesc">
                            è¯¦ç»†æè¿°
                        </div>
                    </div>

                    <!-- å¤šå›¾æŒ‡ç¤ºå™¨ï¼ˆæœªæ¥æ‰©å±•ï¼‰ -->
                    <div class="image-indicators" id="imageIndicators" style="display: none;">
                        <span class="indicator-dot active"></span>
                        <span class="indicator-dot"></span>
                        <span class="indicator-dot"></span>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="modal-action" onclick="previousImage()" id="prevBtn" style="display: none;">
                    â¬…ï¸ ä¸Šä¸€å¼ 
                </button>
                <button class="modal-action primary" onclick="closeModal()">
                    ç¡®å®š
                </button>
                <button class="modal-action" onclick="nextImage()" id="nextBtn" style="display: none;">
                    ä¸‹ä¸€å¼  â¡ï¸
                </button>
            </div>
        </div>
    </div>

    <script>
        // æ’å›¾æ•°æ®åº“
        const illustrations = {
            scene: {
                emoji: 'ğŸšï¸',
                title: 'åºŸå¼ƒçš„å®éªŒå®¤',
                caption: 'ã€Œå°˜å°å·²ä¹…çš„ç§˜å¯†åŸºåœ°ã€',
                desc: 'è¿™ä¸ªå®éªŒå®¤ä¼¼ä¹å·²ç»åºŸå¼ƒäº†å¾ˆä¹…ï¼Œä½†å¥‡æ€ªçš„æ˜¯ï¼ŒæŸäº›è®¾å¤‡ä¼¼ä¹è¿˜åœ¨è¿è½¬...'
            },
            diagram: {
                emoji: 'ğŸ“Š',
                title: 'ç¥ç§˜çš„å®éªŒå›¾è¡¨',
                caption: 'ã€ŒProject: Realityã€',
                desc: 'å›¾è¡¨ä¸Šè¯¦ç»†è®°å½•ç€æŸç§äººä½“æ”¹é€ è®¡åˆ’ï¼Œå…¶ä¸­"User"å’Œ"Zero"çš„ä»£å·åå¤å‡ºç°ã€‚çº¢è‰²çš„çº¿æ¡è¿æ¥ç€å„ä¸ªèŠ‚ç‚¹ï¼Œæœ€ä¸­å¿ƒå†™ç€"è®°å¿†æ¤å…¥"å››ä¸ªå¤§å­—ã€‚'
            },
            diary: {
                emoji: 'ğŸ“”',
                title: 'ç ”ç©¶å‘˜çš„æ—¥è®°',
                caption: 'ã€Œ2024å¹´3æœˆ15æ—¥ - æœ€åçš„è®°å½•ã€',
                desc: 'å­—è¿¹æ½¦è‰ï¼š"å®éªŒä½“è§‰é†’äº†è‡ªæˆ‘æ„è¯†...è¿™ä¸åœ¨è®¡åˆ’ä¹‹å†…...Bç»„ç»‡çš„äººè¦æ¥äº†...å¿…é¡»é”€æ¯ä¸€åˆ‡è¯æ®..."'
            },
            device: {
                emoji: 'ğŸ”¬',
                title: 'å¥‡æ€ªçš„å®éªŒè®¾å¤‡',
                caption: 'ã€Œè®°å¿†æ‰«æä»ª MK-VIIã€',
                desc: 'è®¾å¤‡çš„æ˜¾ç¤ºå±è¿˜åœ¨å¾®å¾®å‘å…‰ï¼Œä¸Šé¢æ˜¾ç¤ºç€"æœ€åæ‰«æï¼š72å°æ—¶å‰"ã€‚æ—è¾¹çš„åŸ¹å…»çš¿é‡Œæœ‰ä¸€äº›å‘å…‰çš„æ¶²ä½“ã€‚'
            },
            photo: {
                emoji: 'ğŸ“·',
                title: 'æ³›é»„çš„åˆå½±',
                caption: 'ã€Œå®éªŒå›¢é˜Ÿ - 2023ã€',
                desc: 'ç…§ç‰‡ä¸Šæœ‰äº”ä¸ªç©¿ç€ç™½å¤§è¤‚çš„ç ”ç©¶å‘˜ï¼Œå…¶ä¸­ä¸€ä¸ªäººçš„è„¸è¢«åˆ»æ„æ¶‚é»‘äº†ã€‚èƒŒæ™¯æ˜¯è¿™ä¸ªå®éªŒå®¤ï¼Œä½†çœ‹èµ·æ¥è¦æ•´æ´å¾—å¤šã€‚'
            }
        };

        let currentIllustration = null;
        let isZoomed = false;

        // æ˜¾ç¤ºæ’å›¾
        function showIllustration(type) {
            const data = illustrations[type];
            if (!data) return;

            currentIllustration = data;

            // æ›´æ–°æ¨¡æ€æ¡†å†…å®¹
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('illustrationImage').innerHTML = data.emoji;
            document.getElementById('illustrationCaption').textContent = data.caption;
            document.getElementById('illustrationDesc').textContent = data.desc;

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const overlay = document.getElementById('modalOverlay');
            overlay.classList.add('active');

            // é‡ç½®ç¼©æ”¾
            isZoomed = false;
            document.getElementById('illustrationImage').classList.remove('zoomed');
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            const overlay = document.getElementById('modalOverlay');
            overlay.classList.remove('active');

            // å»¶è¿Ÿæ¸…ç†å†…å®¹
            setTimeout(() => {
                currentIllustration = null;
                isZoomed = false;
            }, 400);
        }

        // ç‚¹å‡»èƒŒæ™¯å…³é—­
        function closeOnBackground(event) {
            if (event.target === event.currentTarget) {
                closeModal();
            }
        }

        // åˆ‡æ¢ç¼©æ”¾
        function toggleZoom() {
            const image = document.getElementById('illustrationImage');
            isZoomed = !isZoomed;

            if (isZoomed) {
                image.classList.add('zoomed');
            } else {
                image.classList.remove('zoomed');
            }
        }

        // é€‰æ‹©é€‰é¡¹
        function selectChoice(element) {
            // æ·»åŠ é€‰ä¸­æ•ˆæœ
            element.style.background = 'rgba(139, 92, 246, 0.3)';

            setTimeout(() => {
                element.style.background = '';
                continueStory();
            }, 300);
        }

        // ç»§ç»­æ•…äº‹
        function continueStory() {
            const f1 = document.querySelector('.f1-area');
            f1.style.opacity = '0.5';

            setTimeout(() => {
                f1.innerHTML = `
                    <div class="location-tag">ğŸ“ å®éªŒå®¤æ·±å¤„</div>
                    <div class="story-text">
                        <p>ä½ çš„é€‰æ‹©æ¨åŠ¨äº†æ•…äº‹çš„å‘å±•...</p>
                        <p>æ–°çš„åœºæ™¯å·²åŠ è½½ã€‚</p>
                    </div>
                `;
                f1.style.opacity = '1';
            }, 300);
        }

        // é‡ç½®åœºæ™¯
        function resetScene() {
            location.reload();
        }

        // ESCé”®å…³é—­
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒï¼ˆPWAï¼‰
        let touchStartY = 0;
        const modalBody = document.querySelector('.modal-body');

        modalBody?.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        });

        modalBody?.addEventListener('touchend', (e) => {
            const touchEndY = e.changedTouches[0].clientY;
            const diff = touchStartY - touchEndY;

            // ä¸‹æ»‘å…³é—­
            if (diff < -100) {
                closeModal();
            }
        });

        // é˜²æ­¢iOSæ©¡çš®ç­‹æ•ˆæœ
        document.body.addEventListener('touchmove', (e) => {
            if (document.getElementById('modalOverlay').classList.contains('active')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>