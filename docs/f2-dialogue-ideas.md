# 💭 F2区域对话系统灵感记录

## 📱 移动端/PWA适配
### 退出机制
- ❌ 不能依赖ESC键（手机没有）
- ✅ 在AI模式的"更多功能"按钮里加入"结束对话"选项
- ✅ 或者把继续按钮改成"返回"按钮（AI模式时）

### 快捷菜单扩展
```
AI对话模式时，点击"更多功能"按钮：
┌─────────────────┐
│ 📝 对话记录     │
│ 💾 保存对话     │
│ 🔇 静音模式     │
│ 🎭 切换人格     │
│ ↩️ 结束对话     │
└─────────────────┘
```

## 🎯 NPC互动触发方式

### 1. NPC主动搭话系统
```javascript
// 设计思路
npcInitiative: {
    conditions: {
        affection: ">= 40",     // 好感度阈值
        mood: ["happy", "curious", "angry"],  // 心情影响
        personality: "outgoing", // 性格决定主动性
        lastMet: ">= 3days"     // 多久没见会想你
    },

    // F1显示
    display: "Zero看到你，眼神闪烁了一下...",

    // 玩家选择
    choices: [
        "打招呼" → 切换AI模式,
        "装作没看见" → 继续剧情,
        "微笑点头" → 好感度+3
    ]
}
```

### 2. 头像点击交互菜单
```
点击NPC头像后弹出圆形菜单：
        [观察]
    [交谈]   [离开]
        [赠送]
```

### 3. 群聊模式设计
#### 方案A：多API并行（推荐）
- 每个NPC独立API接口
- 各自保持独立记忆流
- 避免混乱

#### 方案B：娱乐模式
- 不保存到长期记忆
- 纯粹的即时互动
- 减轻系统负担

## 📊 记忆系统分层（大项目，分步实施）

### 第一阶段：基础记忆 ⏳
- 简单的对话次数统计
- 最后对话时间记录
- 好感度变化追踪

### 第二阶段：情感记忆 ⏳
```javascript
emotionalMemory: {
    positiveEvents: [],  // 开心的互动
    negativeEvents: [],  // 不愉快经历
    keyMoments: []       // 关键剧情节点
}
```

### 第三阶段：上下文记忆 ⏳
- 对话历史摘要
- 话题偏好记录
- 玩家选择倾向分析

### 第四阶段：长期记忆压缩 ⏳
- 旧记忆自动归档
- 重要记忆标记永久
- 记忆检索优化

## 🎨 UI/UX优化想法

### 对话界面美化
- 打字机效果
- NPC头像呼吸动画
- 情绪气泡（开心/生气/害羞）

### 智能提示系统
```
F1区提醒样式：
┌─────────────────────────┐
│ ✨ Zero已接入AI系统     │
│ 💡 对话将更加智能自然   │
└─────────────────────────┘
```

### 对话状态指示器
- 🟢 在线（API正常）
- 🟡 思考中（等待回复）
- 🔴 离线（使用脚本对话）

## 🚀 未来功能设想

### 语音输入（PWA）
- 利用Web Speech API
- 语音转文字输入
- 适合移动端使用

### 情绪识别
- 分析玩家输入的情绪
- NPC相应调整回复语气
- 影响好感度变化

### 多语言支持
- 中英文切换
- 方言模式（有趣）
- 古风/现代语言风格

### 对话分支影响
```
根据对话内容影响剧情：
- 提到特定关键词 → 解锁隐藏剧情
- 情感积累到阈值 → 触发特殊事件
- 选择倾向分析 → 影响NPC性格发展
```

## 📝 实施优先级

### 立即可做 ✅
1. 在F2"更多功能"菜单加入AI模式选项
2. 统一对话框UI设计
3. 基础的NPC主动对话触发

### 短期目标 🎯
1. 完善移动端交互体验
2. 实现头像点击菜单
3. 基础记忆系统（对话次数、时间）

### 中期目标 📅
1. 群聊模式实现
2. 情感记忆系统
3. 对话历史查看

### 长期愿景 🌟
1. 完整的记忆管理系统
2. 语音输入支持
3. 高级AI人格切换
4. 对话影响剧情系统

## 🐛 需要解决的问题

### 技术挑战
- API调用频率限制
- 记忆存储容量优化
- 多API key管理
- 对话上下文长度限制

### 用户体验
- 如何优雅地处理API失败
- 对话加载时的等待体验
- 移动端键盘弹出处理
- 横竖屏切换适配

### 游戏平衡
- AI对话vs脚本对话的平衡
- 付费玩家vs免费玩家体验
- 记忆系统对游戏难度的影响

---

*这个文件会持续更新，记录所有关于F2对话系统的创意和想法*