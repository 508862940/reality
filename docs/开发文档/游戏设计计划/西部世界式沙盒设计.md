# 🎮 Reality游戏 - 西部世界式沙盒设计方案

## 核心理念
打造一个类似《西部世界》的游戏世界，玩家如同"访客"自由探索，而NPC分为"循环脚本"和"觉醒者"两类。

## 一、NPC分层系统

### 1. 背景NPC（90%）- 循环脚本
- **特点**：固定对话循环，如西部世界的普通Host
- **成员**：路人、店员、同学、清洁工等
- **技术**：纯脚本驱动，不消耗API
- **对话**：3-5句固定台词循环

### 2. 功能NPC（8%）- 条件触发
- **特点**：根据玩家状态触发不同对话
- **成员**：任务NPC、商人、门卫等
- **技术**：条件分支脚本
- **对话**：10-20句条件对话

### 3. 觉醒NPC（2%）- API驱动
- **特点**：如西部世界的觉醒Host，有自主意识
- **成员**：
  - 林学长（温柔学霸）
  - 张同学（阳光运动）
  - 夜同学（神秘转学生）
  - 小明（青梅竹马）
- **技术**：API接入，深度对话
- **影响**：可影响剧情走向，但有限度

## 二、场景系统三层次

### C区 - 场景预览
- 当前位置的视觉提示
- 环境氛围展示

### D区 - 地图导航
- 可解锁地点列表
- 快速传送功能
- 显示解锁状态：
  - 🔒 未解锁
  - ✨ 可探索
  - 📍 任务地点

### F1区 - 行动选项
- 当前场景内的具体互动
- 动态变化的选项列表
- 根据时间/条件/物品显示

## 三、沙盒世界架构

### 自由探索系统
```
玩家体验流程：
├── 随意探索
│   ├── 发现新区域
│   ├── 收集物品
│   ├── 观察NPC日常
│   └── 触发随机事件
│
├── 解锁机制
│   ├── 区域解锁（需要钥匙/条件）
│   ├── NPC解锁（完成前置任务）
│   ├── 功能解锁（技能/道具）
│   └── 剧情解锁（达成条件）
│
└── 暗线剧情
    ├── 主线任务（可选择性推进）
    ├── 支线任务（探索中发现）
    ├── 隐藏剧情（特定条件触发）
    └── 多结局（基于选择累积）
```

### 关键设计点
1. **非线性**：玩家可以选择完全不推进主线
2. **探索奖励**：发现隐藏内容获得成就感
3. **软引导**：通过环境和NPC暗示，而非强制任务
4. **重玩价值**：不同选择导致不同体验

## 四、F2区对话系统

### 触发条件
- 只在遇到觉醒NPC时显示
- 需要满足解锁条件
- 特定地点/时间触发

### 对话影响
- **可以影响**：
  - NPC好感度
  - 解锁支线剧情
  - 获得特殊物品
  - 改变NPC态度

- **不能影响**：
  - 核心主线走向
  - 世界规则设定
  - 其他玩家体验（单机）

## 五、实现优先级

### 第一阶段：基础框架
1. ✅ 界面布局完成
2. ✅ 滚动条系统
3. ✅ 底部安全区适配
4. ⏳ F1区动态选项系统
5. ⏳ D区地图导航

### 第二阶段：核心系统
1. ⏳ NPC分层实现
2. ⏳ 区域解锁机制
3. ⏳ 物品收集系统
4. ⏳ 时间流逝系统

### 第三阶段：内容填充
1. ⏳ 背景NPC对话
2. ⏳ 功能NPC任务
3. ⏳ 觉醒NPC人设
4. ⏳ 地图场景设计

### 第四阶段：深度功能
1. ⏳ API对话系统
2. ⏳ 暗线剧情编写
3. ⏳ 多结局设计
4. ⏳ 成就系统

## 六、技术要点

### NPC管理结构
```javascript
const NPCManager = {
    // 背景NPC - 西部世界的"日常循环"
    backgroundNPCs: {
        "路人A": {
            loop: ["今天天气真好", "要迟到了", "..."],
            resetTime: "daily"
        }
    },

    // 功能NPC - 有条件分支的Host
    functionalNPCs: {
        "图书管理员": {
            conditions: {
                default: "图书馆需要保持安静",
                hasBook: "要还书吗？",
                questActive: "你在找什么东西吗？"
            }
        }
    },

    // 觉醒NPC - 接入API的"觉醒者"
    awakenedNPCs: {
        "林学长": {
            useAPI: true,
            model: "gemini",
            unlockCondition: "library_key_obtained",
            personality: "温柔可靠的学霸",
            memories: [] // 对话历史
        }
    }
}
```

### 地图解锁数据
```javascript
const MapSystem = {
    areas: {
        "图书馆": {
            status: "locked",
            unlockItem: "student_card",
            subAreas: {
                "一楼大厅": "unlocked",
                "二楼书库": "locked",
                "禁书区": "hidden"
            }
        }
    }
}
```

## 七、设计灵感来源

### 西部世界参考
- **循环与觉醒**：大部分NPC按脚本行动，少数可深度交流
- **迷宫核心**：暗线剧情需要玩家主动发现
- **自由意志**：玩家选择决定体验深度

### 其他参考
- **Degrees of Lewdity**：高自由度沙盒
- **星露谷物语**：NPC日常作息
- **底特律变人**：选择影响剧情

## 八、注意事项

1. **成本控制**：API调用仅限4个核心NPC
2. **体验平衡**：自由探索与剧情推进的平衡
3. **引导设计**：软引导而非硬性任务
4. **兜底设计**：即使不触发主线也有内容可玩

---

**文档创建时间**：2024年
**设计理念**：西部世界式的AI觉醒者与脚本循环者共存
**核心特色**：高自由度沙盒 + 选择性API深度对话