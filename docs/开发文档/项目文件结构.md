# 📁 项目文件结构指南

## 🗂️ 目录结构

```
yozi/
├── 📄 app.html                    # 新的统一入口（SPA单页应用）
├── 📄 index.html                  # 原版游戏（备份保留）
├── 📄 manifest.json               # PWA配置
├── 📄 sw.js                       # Service Worker
├── 📄 README.md                   # 项目说明
│
├── 📁 css/                        # 样式文件目录
│   ├── app.css                   # 统一基础样式（新建）
│   ├── menu.css                  # 菜单页面样式
│   ├── character-creation.css    # 角色创建样式
│   ├── game-main.css             # 游戏主界面样式
│   └── styles-old.css            # 原版样式（备份）
│
├── 📁 js/                         # JavaScript目录
│   ├── 📁 core/                  # 核心系统
│   │   ├── game-engine.js       # 游戏引擎（基于原game.js）
│   │   ├── advanced-game.js     # 高级游戏系统
│   │   ├── data-bridge.js       # 数据桥接（新建）
│   │   └── app-router.js        # 路由系统（新建）
│   │
│   ├── 📁 ai/                    # AI系统
│   │   ├── ai-config.js         # 通用AI对话系统
│   │   └── ai-npc-system.js     # 主角NPC专用AI系统
│   │
│   ├── 📁 api/                   # API管理
│   │   ├── api-manager.js       # API管理器核心
│   │   ├── api-config-ui.js     # 旧版配置UI
│   │   ├── api-settings-ui.js   # 新版设置UI
│   │   └── api-state.js         # API状态管理
│   │
│   ├── 📁 pages/                 # 页面逻辑
│   │   ├── menu.js              # 菜单页面逻辑
│   │   ├── character-creation.js # 角色创建逻辑
│   │   └── game-main.js         # 游戏主界面逻辑
│   │
│   └── 📁 utils/                 # 工具函数
│       ├── app-init.js          # 应用初始化（新建）
│       ├── storage.js           # 存储管理（新建）
│       └── emergency-fix.js     # 紧急修复脚本
│
├── 📁 pages/                      # HTML页面片段
│   ├── menu.html                 # 菜单页面内容
│   ├── character-creation.html   # 角色创建页面内容
│   └── game-main.html            # 游戏主界面内容
│
├── 📁 config/                     # 配置文件
│   ├── api-config.js             # API密钥配置（用户配置）
│   ├── api-config-example.js     # API配置示例
│   └── game-config.js            # 游戏配置（新建）
│
├── 📁 backup/                     # 备份文件
│   ├── index.html                # 原版主页备份
│   ├── game.js                   # 原版游戏逻辑备份
│   ├── styles.css                # 原版样式备份
│   └── test-ai.html              # AI测试页备份
│
├── 📁 assets/                     # 静态资源（预留）
│   ├── 📁 icons/                 # 图标
│   ├── 📁 sounds/                # 音效
│   └── 📁 images/                # 图片
│
├── 📁 docs/                       # 文档目录
│   ├── 📁 开发文档/
│   │   ├── PROJECT_REQUIREMENTS.md
│   │   ├── GAME_DESIGN.md
│   │   ├── 项目完整评估报告.md
│   │   ├── 项目改进路线图.md
│   │   └── 项目文件结构.md      # 本文件
│   └── 📁 用户文档/
│       └── ...
│
└── 📁 样式参考/                   # 参考文件
    └── ...
```

## 📝 文件说明

### 核心文件

#### app.html
- **作用**: 新的SPA单页应用入口
- **功能**: 加载所有资源，管理页面切换
- **状态**: 待创建

#### js/core/game-engine.js
- **作用**: 游戏核心引擎
- **来源**: 基于原game.js整合
- **功能**: 游戏逻辑、地点管理、角色状态

#### js/core/advanced-game.js
- **作用**: 高级游戏系统
- **功能**: 时间系统、事件系统、物品系统、技能系统
- **状态**: 已创建，待集成

### AI系统（双系统并行）

#### js/ai/ai-config.js
- **作用**: 通用AI对话系统
- **用途**: 处理随机事件、普通对话

#### js/ai/ai-npc-system.js
- **作用**: 主角NPC专用系统
- **用途**: 4个主要NPC的AI对话
- **NPC**: 林学长、张同学、夜同学、小明

### API管理系统

#### js/api/api-manager.js
- **作用**: API管理核心
- **功能**: 管理多个API配置、切换、测试

#### js/api/api-settings-ui.js
- **作用**: 新版设置UI
- **功能**: 页面内API配置管理

#### js/api/api-state.js
- **作用**: 状态管理
- **功能**: 统一管理API配置状态

### 页面系统

#### pages/目录
- **作用**: 存放HTML页面片段
- **特点**: 只包含body内容，由路由动态加载

#### js/pages/目录
- **作用**: 页面对应的JavaScript逻辑
- **对应**: 每个HTML页面有对应的JS文件

## 🔄 文件迁移记录

### 已迁移文件

| 原位置 | 新位置 | 状态 |
|--------|--------|------|
| menu-styles.css | css/menu.css | ⏳ 待迁移 |
| character-creation.css | css/character-creation.css | ⏳ 待迁移 |
| game-main.css | css/game-main.css | ⏳ 待迁移 |
| styles.css | backup/styles.css | ⏳ 待迁移 |
| advanced-game.js | js/core/advanced-game.js | ⏳ 待迁移 |
| ai-config.js | js/ai/ai-config.js | ⏳ 待迁移 |
| ai-npc-system.js | js/ai/ai-npc-system.js | ⏳ 待迁移 |
| api-manager.js | js/api/api-manager.js | ⏳ 待迁移 |
| api-config-ui.js | js/api/api-config-ui.js | ⏳ 待迁移 |
| js/api-settings-ui.js | js/api/api-settings-ui.js | ⏳ 待迁移 |
| js/api-state.js | js/api/api-state.js | ⏳ 待迁移 |
| menu.js | js/pages/menu.js | ⏳ 待迁移 |
| character-creation.js | js/pages/character-creation.js | ⏳ 待迁移 |
| game-main.js | js/pages/game-main.js | ⏳ 待迁移 |
| emergency-fix.js | js/utils/emergency-fix.js | ⏳ 待迁移 |
| api-config.js | config/api-config.js | ⏳ 待迁移 |
| api-config-example.js | config/api-config-example.js | ⏳ 待迁移 |

### 新建文件

| 文件路径 | 用途 | 状态 |
|----------|------|------|
| app.html | SPA入口 | ⏳ 待创建 |
| css/app.css | 统一样式 | ⏳ 待创建 |
| js/core/app-router.js | 路由系统 | ⏳ 待创建 |
| js/core/data-bridge.js | 数据桥接 | ⏳ 待创建 |
| js/core/game-engine.js | 游戏引擎 | ⏳ 待创建 |
| js/utils/app-init.js | 初始化 | ⏳ 待创建 |
| js/utils/storage.js | 存储管理 | ⏳ 待创建 |
| config/game-config.js | 游戏配置 | ⏳ 待创建 |

## 🚀 实施步骤

1. ✅ 创建本文档
2. ⏳ 创建所需文件夹结构
3. ⏳ 迁移CSS文件
4. ⏳ 迁移JS文件
5. ⏳ 迁移HTML文件
6. ⏳ 迁移配置文件
7. ⏳ 创建备份
8. ⏳ 创建新文件
9. ⏳ 更新文件引用
10. ⏳ 测试集成

## 📌 注意事项

1. **保持兼容性**: 不删除原有功能，只重组结构
2. **备份优先**: 所有原文件先备份再迁移
3. **逐步测试**: 每个模块迁移后立即测试
4. **文档同步**: 迁移完成后更新相关文档

## 🔧 维护指南

### 添加新功能
1. 确定功能类别（核心/AI/API/页面/工具）
2. 在对应目录创建文件
3. 更新本文档
4. 测试集成

### 修改现有功能
1. 在对应目录找到文件
2. 修改前先备份
3. 测试修改影响
4. 更新文档

---

**最后更新**: 2024年12月
**维护者**: AI助手 & 开发者
**版本**: v1.0